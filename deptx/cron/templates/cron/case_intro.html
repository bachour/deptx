{% extends 'cron/base.html' %}
{% load staticfiles %}
{% block content %}

<h1>{{ case.name }}</h1>
<h2>Background</h2>
{{ text }}
<h2>Required Documents:</h2>
<table class="banner-1">
	<tr>
		<th></th>
		<th></th>
		<th>name</th>
		<th>identification number</th>
		<th>unit</th>
		<th>level</th>
		<th>TRUST</th>
	</tr>
{% for cronDocument in cronDocument_list %}
	<tr style='vertical-align:middle' {% if not cronDocument.available %}class='missing'{% endif %}>
		<td>
			{% if cronDocument.solved %}
				<div style="position:relative; width:80px;">
					<div style="position:absolute;top:50%;margin-top:-25px">
						<img src='{{MEDIA_URL}}content/solved.png'/ style='width:80px;'>
					</div>
					<div>
						{% for i in cronDocument.getStarsForTemplate %}<img width="32px" src="{% static 'cron/images/hat.png' %}" />{% endfor %}
					</div>
				</div>
			{% endif %}
		</td>
		<td>
		{% if cronDocument.available or cheat %}
			<a class='button' href="{% url "cron_provenance" mission.serial case.serial cronDocument.serial %}">{% if cronDocument.solved %}view{% else %}inspect{% endif %}</a>
		{% else %}
			<a class='button' href="{% url 'cron_hack_document' cronDocument.serial %}">hack MoP account</a>
		{% endif %}
		</td>
		<td>{{cronDocument.name}}</td>
		<td>{{cronDocument.serial}}</td>
		<td>{{cronDocument.unit.serial}}</td>
		<td><img style="width:32px;" src="{{cronDocument.getBadgeUrl}}" /></td>
		<td>{{cronDocument.getTrustRequested}}</td>
	</tr>
{% endfor %}
</table>

{% if not cronDocument_list.allAvailable and not caseInstance.isSolved %}
<p>In order to acquire missing documents: 
<ol> 
<li> Login to the Ministry of Provenance  <a href="http://www.mofp.net">Intranet</a>.</li>
<li> Request the document following their standard procedures (make sure you have gained enough TRUST!).</li>
<li> Then, compose a message and attach the document to it, but do NOT send it. </li>
<li> Instead save it as a draft. </li>
<li> When you have done so, return here and click the "Hack MoP Account" above.</li>
</ol>
Our hackers will access your MoP Draft folder to retrieve the document and bypass MoP mail monitoring systems.</p>
<br/>
{% endif %}
{% if not cronDocument_list.allMissing and not caseInstance.isSolved %}
<p>You can now use our own Provenance Viewing tool to inspect the document. Your mission is to examine the document and highlight any inconsistencies in the attributes of the node:</p>

<ol>
<li>Click the "inspect" link above.</li>
<li>Start by spreading out the nodes.</li>
<li>Try to arrange them in a way that helps you understand the sequence of events portrayed in the graph.</li>
<li>Find out if any attributes are inconsistent. Highlight them and then click "Submit report".</li>
<li>If you think there are no inconsistencies, make sure no attributes are selected and then click "Submit report".</li>
</ol>
{% endif %}
<br/>
{% if caseInstance.isSolved %}
<p>This case is now resolved! Great job!</p>
<br/>
<p><a href="{% url 'cron_case_outro' mission.serial case.serial %}">Continue to Outcome</a></p>
{% else %}
<p><a href="{% url 'cron_mission_cases' mission.serial %}">Back to Mission Overview</a></p>
{% endif %}
{% endblock %}
